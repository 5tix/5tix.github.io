<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JeepNav - Real-time Public Transport Tracking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Mapbox GL JS -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 3px;
        }
        
        /* Pulse animation for active vehicles */
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Map container */
        #map {
            height: 60vh;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        /* Custom marker styling */
        .mapboxgl-marker {
            cursor: pointer;
        }
        
        .bus-marker {
            background-image: url('https://cdn-icons-png.flaticon.com/512/477/477103.png');
            background-size: cover;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .stop-marker {
            background-color: #ef4444;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        /* Route line animation */
        .route-line {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 5s linear forwards;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: 0;
            }
        }
        
        /* Map controls */
        .mapboxgl-ctrl-top-right {
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">
    <!-- App Container -->
    <div class="max-w-md mx-auto bg-white shadow-lg rounded-b-xl overflow-hidden">
        <!-- Header -->
        <header class="bg-blue-600 text-white p-4 shadow-md">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-bus text-2xl"></i>
                    <h1 class="text-xl font-bold">JeepNav</h1>
                </div>
                <div class="flex items-center space-x-3">
                    <button class="p-2 rounded-full bg-blue-500 hover:bg-blue-400 transition">
                        <i class="fas fa-bell"></i>
                    </button>
                    <button class="p-2 rounded-full bg-blue-500 hover:bg-blue-400 transition">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            </div>
            
            <!-- Search Bar -->
            <div class="mt-4 relative">
                <input type="text" placeholder="Search routes or destinations..." 
                       class="w-full py-3 px-4 pr-10 rounded-full bg-blue-500 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-300">
                <button class="absolute right-3 top-3 text-blue-200 hover:text-white">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </header>
        
        <!-- Main Content -->
        <main class="pb-20">
            <!-- Map Container -->
            <div id="map"></div>
            
            <!-- Quick Actions -->
            <div class="p-4 flex justify-around border-b">
                <button class="flex flex-col items-center text-blue-600">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-1">
                        <i class="fas fa-star"></i>
                    </div>
                    <span class="text-xs">Favorites</span>
                </button>
                <button class="flex flex-col items-center text-blue-600">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-1">
                        <i class="fas fa-history"></i>
                    </div>
                    <span class="text-xs">Recent</span>
                </button>
                <button class="flex flex-col items-center text-blue-600">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-1">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <span class="text-xs">Nearby</span>
                </button>
                <button class="flex flex-col items-center text-blue-600">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-1">
                        <i class="fas fa-cog"></i>
                    </div>
                    <span class="text-xs">Settings</span>
                </button>
            </div>
            
            <!-- Active Routes Section -->
            <div class="p-4">
                <h2 class="text-lg font-semibold mb-3 flex items-center">
                    <i class="fas fa-bus mr-2 text-blue-600"></i> Active Routes in Tuguegarao
                </h2>
                
                <div class="space-y-3">
                    <!-- Route Card 1 -->
                    <div class="bg-white rounded-lg shadow p-3 border-l-4 border-blue-500">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-medium">Route 1A</h3>
                                <p class="text-sm text-gray-600">Centro - Cataggaman</p>
                            </div>
                            <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">3 min away</span>
                        </div>
                        <div class="mt-2 flex items-center text-sm">
                            <span class="text-yellow-500 mr-1"><i class="fas fa-circle"></i></span>
                            <span class="text-gray-500">Current stop: Tuguegarao City Hall</span>
                        </div>
                        <div class="mt-2 flex justify-between text-xs text-gray-500">
                            <span>Next: CSU Andrews Campus</span>
                            <span>ETA: 8 min</span>
                        </div>
                    </div>
                    
                    <!-- Route Card 2 -->
                    <div class="bg-white rounded-lg shadow p-3 border-l-4 border-green-500">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-medium">Route 2B</h3>
                                <p class="text-sm text-gray-600">Centro - Pengue Ruyu</p>
                            </div>
                            <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Arriving now</span>
                        </div>
                        <div class="mt-2 flex items-center text-sm">
                            <span class="text-yellow-500 mr-1"><i class="fas fa-circle"></i></span>
                            <span class="text-gray-500">Current stop: SM Center Tuguegarao</span>
                        </div>
                        <div class="mt-2 flex justify-between text-xs text-gray-500">
                            <span>Next: Tuguegarao Cathedral</span>
                            <span>ETA: 5 min</span>
                        </div>
                    </div>
                    
                    <!-- Route Card 3 -->
                    <div class="bg-white rounded-lg shadow p-3 border-l-4 border-purple-500">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-medium">Route 3C</h3>
                                <p class="text-sm text-gray-600">Centro - Ugac</p>
                            </div>
                            <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">15 min away</span>
                        </div>
                        <div class="mt-2 flex items-center text-sm">
                            <span class="text-yellow-500 mr-1"><i class="fas fa-circle"></i></span>
                            <span class="text-gray-500">Current stop: Cagayan State University</span>
                        </div>
                        <div class="mt-2 flex justify-between text-xs text-gray-500">
                            <span>Next: Ugac Market</span>
                            <span>ETA: 12 min</span>
                        </div>
                    </div>
                </div>
                
                <button class="mt-4 w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center">
                    <i class="fas fa-plus-circle mr-2"></i> View All Routes
                </button>
            </div>
        </main>
        
        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 max-w-md w-full bg-white border-t flex justify-around py-2">
            <a href="#" class="p-2 text-blue-600 flex flex-col items-center">
                <i class="fas fa-home text-xl"></i>
                <span class="text-xs mt-1">Home</span>
            </a>
            <a href="#" class="p-2 text-gray-500 hover:text-blue-600 flex flex-col items-center">
                <i class="fas fa-map text-xl"></i>
                <span class="text-xs mt-1">Map</span>
            </a>
            <a href="#" class="p-2 text-gray-500 hover:text-blue-600 flex flex-col items-center">
                <i class="fas fa-route text-xl"></i>
                <span class="text-xs mt-1">Routes</span>
            </a>
            <a href="#" class="p-2 text-gray-500 hover:text-blue-600 flex flex-col items-center">
                <i class="fas fa-bell text-xl"></i>
                <span class="text-xs mt-1">Alerts</span>
            </a>
            <a href="#" class="p-2 text-gray-500 hover:text-blue-600 flex flex-col items-center">
                <i class="fas fa-user text-xl"></i>
                <span class="text-xs mt-1">Profile</span>
            </a>
        </nav>
    </div>
    
    <!-- JavaScript for Mapbox and interactivity -->
    <script>
        // Mapbox access token (replace with your own token)
        mapboxgl.accessToken = 'sk.eyJ1IjoiY2p0YW4iLCJhIjoiY21hYzNqdWl2MDA4NjJrcXdpbHVmMXBxZiJ9.ibYdjDEbtVA08MeOlZ5FJw';
        
        // Initialize map centered on Tuguegarao City, Philippines
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [121.7333, 17.6131], // Tuguegarao coordinates
            zoom: 13
        });
        
        // Add navigation controls
        map.addControl(new mapboxgl.NavigationControl());
        
        // Add geolocate control
        map.addControl(
            new mapboxgl.GeolocateControl({
                positionOptions: {
                    enableHighAccuracy: true
                },
                trackUserLocation: true,
                showUserHeading: true
            })
        );
        
        // Sample jeepney routes in Tuguegarao
        const routes = [
            {
                name: "Route 1A",
                stops: [
                    [121.7333, 17.6131], // Centro
                    [121.7365, 17.6152], // City Hall
                    [121.7398, 17.6183], // CSU Andrews
                    [121.7421, 17.6215]  // Cataggaman
                ],
                color: "#3b82f6"
            },
            {
                name: "Route 2B",
                stops: [
                    [121.7333, 17.6131], // Centro
                    [121.7301, 17.6150], // SM Center
                    [121.7278, 17.6172], // Cathedral
                    [121.7255, 17.6200]  // Pengue Ruyu
                ],
                color: "#10b981"
            },
            {
                name: "Route 3C",
                stops: [
                    [121.7333, 17.6131], // Centro
                    [121.7355, 17.6100], // CSU Main
                    [121.7380, 17.6075], // Ugac Market
                    [121.7400, 17.6050]  // Ugac Terminal
                ],
                color: "#8b5cf6"
            }
        ];
        
        // Add route lines and stops to the map
        function addRoutes() {
            routes.forEach(route => {
                // Add route line
                map.on('load', () => {
                    map.addLayer({
                        id: `route-${route.name}`,
                        type: 'line',
                        source: {
                            type: 'geojson',
                            data: {
                                type: 'Feature',
                                properties: {},
                                geometry: {
                                    type: 'LineString',
                                    coordinates: route.stops
                                }
                            }
                        },
                        layout: {
                            'line-join': 'round',
                            'line-cap': 'round'
                        },
                        paint: {
                            'line-color': route.color,
                            'line-width': 3
                        }
                    });
                });
                
                // Add stops
                route.stops.forEach((stop, i) => {
                    const el = document.createElement('div');
                    el.className = 'stop-marker';
                    
                    new mapboxgl.Marker(el)
                        .setLngLat(stop)
                        .setPopup(new mapboxgl.Popup({ offset: 25 })
                            .setHTML(`<h3>${route.name} - Stop ${i+1}</h3>`))
                        .addTo(map);
                });
            });
        }
        
        // Add moving jeepney markers
        function addJeepneys() {
            routes.forEach(route => {
                const el = document.createElement('div');
                el.className = 'bus-marker';
                
                const marker = new mapboxgl.Marker(el)
                    .setLngLat(route.stops[0])
                    .addTo(map);
                
                // Animate marker along route
                let currentStop = 0;
                const animate = () => {
                    const nextStop = (currentStop + 1) % route.stops.length;
                    const start = route.stops[currentStop];
                    const end = route.stops[nextStop];
                    
                    // Simple linear interpolation for demo
                    let progress = 0;
                    const duration = 5000; // 5 seconds between stops
                    const startTime = Date.now();
                    
                    const animateStep = () => {
                        const elapsed = Date.now() - startTime;
                        progress = Math.min(elapsed / duration, 1);
                        
                        const lng = start[0] + (end[0] - start[0]) * progress;
                        const lat = start[1] + (end[1] - start[1]) * progress;
                        
                        marker.setLngLat([lng, lat]);
                        
                        if (progress < 1) {
                            requestAnimationFrame(animateStep);
                        } else {
                            currentStop = nextStop;
                            setTimeout(animate, 1000); // Pause at stop
                        }
                    };
                    
                    animateStep();
                };
                
                setTimeout(animate, Math.random() * 2000); // Start at random times
            });
        }
        
        // Initialize map features
        map.on('load', () => {
            addRoutes();
            addJeepneys();
        });
        
        // Bottom nav interactivity
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('nav a').forEach(l => l.classList.remove('text-blue-600'));
                    this.classList.add('text-blue-600');
                });
            });
        });
    </script>
</body>
</html>